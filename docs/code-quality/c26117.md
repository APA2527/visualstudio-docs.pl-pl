---
title: C26117
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- C26117
helpviewer_keywords:
- C26117
ms.assetid: cc7ebc8d-9826-4cad-a4d5-2d3ad5896734
author: mikeblome
ms.author: mblome
manager: markl
ms.workload:
- multiple
ms.openlocfilehash: 2329c386c267c83a6726d6aa458074ce27ea63b0
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/22/2019
ms.locfileid: "72747028"
---
# <a name="c26117"></a>C26117
Ostrzeżenie C26117: zwalnianie niezautrzymywanej blokady \<lock > w funkcji \<func >.

 Wymuszanie *par z* zakresem *blokowanie i* odblokowywanie w języku C/C++ programy nie jest wykonywane przez język. Funkcja może spowodować zablokowanie efektów ubocznych przez wprowadzenie zauważalnej modyfikacji stanu współbieżności. Na przykład funkcja otoki blokady zwiększa liczbę operacji pozyskiwania blokady lub liczbę blokad dla danej blokady. Można dodać adnotacje do funkcji, która ma efekt uboczny od pobrania lub zwolnienia blokady przy użyciu odpowiednio `_Acquires_lock_` lub `_Releases_lock_`. Bez takich adnotacji funkcja nie zmienia żadnej liczby blokad po powrocie. Jeśli pozyskiwanie i wydania nie są zrównoważone, są one uznawane za *oddzielone*. Ostrzeżenie C26117 jest emitowane, gdy funkcja, która nie ma adnotacji z `_Releases_lock_` zwalnia blokadę, która nie znajduje się, ponieważ funkcja musi być własnością blokady przed jej zwolnieniem.

## <a name="example"></a>Przykład
 Poniższy przykład generuje ostrzeżenie C26117, ponieważ funkcja `ReleaseUnheldLock` zwalnia blokadę, której nie wymaga — stan `flag` jest niejednoznaczny, i nie ma adnotacji, która określa, że powinna.

```cpp

typedef struct _DATA
{
    CRITICAL_SECTION cs;
} DATA;

int flag;

void ReleaseUnheldLock(DATA* p)
{
    if (flag)
        EnterCriticalSection(&p->cs);
    // code ...
    LeaveCriticalSection(&p->cs);
}
```

## <a name="example"></a>Przykład
 Poniższy kod rozwiązuje problem, gwarantując, że zwolnienie blokady jest również nabyte w tych samych warunkach.

```cpp

typedef struct _DATA
{
    CRITICAL_SECTION cs;
} DATA;

int flag;

void ReleaseUnheldLock(DATA* p)
{
    if (flag)
    {
        EnterCriticalSection(&p->cs);
        // code ...
        LeaveCriticalSection(&p->cs);
    }
}
```

## <a name="see-also"></a>Zobacz także

- [C26115](../code-quality/c26115.md)
